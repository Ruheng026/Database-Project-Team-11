SELECT DISTINCT SchCounty
FROM SCHOOL
ORDER BY SchCounty;

SELECT SchName AS SchoolName, School_ID
FROM SCHOOL
WHERE SchCounty = '澎湖縣'
ORDER BY SchName;

SELECT 
    SchName AS SchoolName,
    SchCounty AS SchoolCounty,
    SchAddress AS SchoolAddress
FROM SCHOOL
WHERE School_ID = '164636';

SELECT DISTINCT Semester
FROM GROUP_
WHERE School_ID = '164636'
ORDER BY Semester;

SELECT 
    CONTACT.ConName AS ContactName,
    CONTACT.ConEmail AS ContactEmail,
    CONTACT.ConPhone AS ContactPhone
FROM CONTACT_PERSON AS CONTACT
JOIN SEMESTER_CONTACT 
ON SEMESTER_CONTACT.School_ID = CONTACT.School_ID
AND SEMESTER_CONTACT.ConName = CONTACT.ConName
WHERE SEMESTER_CONTACT.School_ID = '164636' AND SEMESTER_CONTACT.Semester = '1112';

SELECT 
    TRIP.Trip_No,
    TRIP.StartDate,
    TRIP.EndDate
FROM TRIP
JOIN TRIP_SCHOOL ON TRIP.Semester = TRIP_SCHOOL.Semester AND TRIP.Trip_No = TRIP_SCHOOL.Trip_No
WHERE TRIP_SCHOOL.School_ID = '164636' AND TRIP.Semester = '1112'
ORDER BY TRIP.Trip_No;

SELECT 
    OTHER_SCHOOLS.SchName AS OtherSchoolName,
    OTHER_SCHOOLS.SchCounty AS OtherSchoolCounty
FROM TRIP
JOIN TRIP_SCHOOL ON TRIP.Semester = TRIP_SCHOOL.Semester AND TRIP.Trip_No = TRIP_SCHOOL.Trip_No
LEFT JOIN TRIP_SCHOOL AS OTHER_TS ON TRIP.Trip_No = OTHER_TS.Trip_No AND TRIP.Semester = OTHER_TS.Semester AND OTHER_TS.School_ID != TRIP_SCHOOL.School_ID
LEFT JOIN SCHOOL AS OTHER_SCHOOLS ON OTHER_TS.School_ID = OTHER_SCHOOLS.School_ID
WHERE TRIP_SCHOOL.School_ID = '164636' AND TRIP.Semester = '1112';

SELECT 
    TRIP_STUDENT.Trip_No,
    STUDENT.StuName AS StudentName,
    STUDENT.StuNationality AS StudentNationality
FROM TRIP_STUDENT
JOIN STUDENT ON TRIP_STUDENT.ICL_ID = STUDENT.ICL_ID
JOIN TRIP_SCHOOL ON TRIP_STUDENT.Trip_No = TRIP_SCHOOL.Trip_No AND TRIP_STUDENT.Semester = TRIP_SCHOOL.Semester
WHERE TRIP_SCHOOL.School_ID = '164636' AND TRIP_SCHOOL.Semester = '1112';

SELECT DISTINCT Semester
FROM GROUP_
WHERE School_ID = '164636'
ORDER BY Semester;

SELECT Group_ID
FROM GROUP_
WHERE School_ID = '164636' AND Semester = '1112'
ORDER BY Group_ID;

SELECT 
    LOCAL.StuName AS LocalStudentName,
    LOCAL.StuNationality AS LocalStudentNationality,
    LOCAL.StuType AS LocalStudentType,
    LOCAL.StuPhone AS LocalStudentPhone,
    LOCAL.StuEmail AS LocalStudentEmail,
    INTL.StuName AS IntlStudentName,
    INTL.StuNationality AS IntlStudentNationality,
    INTL.StuType AS IntlStudentType,
    INTL.StuPhone AS IntlStudentPhone,
    INTL.StuEmail AS IntlStudentEmail
FROM GROUP_
LEFT JOIN STUDENT AS LOCAL ON GROUP_.LocICL_ID = LOCAL.ICL_ID
LEFT JOIN STUDENT AS INTL ON GROUP_.IntlICL_ID = INTL.ICL_ID
WHERE GROUP_.Group_ID = '00000385';

SELECT 
    SESSION.Date AS SessionDate,
    GROUP_.StartTime,
    GROUP_.EndTime,
    LOCAL_STATUS.AttendType AS LocalStudentAttendStatus,
    INTL_STATUS.AttendType AS IntlStudentAttendStatus
FROM SESSION
JOIN GROUP_ ON SESSION.Group_ID = GROUP_.Group_ID
LEFT JOIN SESSION_ATTENDANCE AS LOCAL_ATTEND ON SESSION.Session_ID = LOCAL_ATTEND.Session_ID AND GROUP_.LocICL_ID = LOCAL_ATTEND.ICL_ID
LEFT JOIN ATTEND_STATUS AS LOCAL_STATUS ON LOCAL_ATTEND.Attend_No = LOCAL_STATUS.Attend_No
LEFT JOIN SESSION_ATTENDANCE AS INTL_ATTEND ON SESSION.Session_ID = INTL_ATTEND.Session_ID AND GROUP_.IntlICL_ID = INTL_ATTEND.ICL_ID
LEFT JOIN ATTEND_STATUS AS INTL_STATUS ON INTL_ATTEND.Attend_No = INTL_STATUS.Attend_No
WHERE GROUP_.Group_ID = '00000385'
ORDER BY SESSION.Date;